================================================================================
DETAILED LINE-BY-LINE DIFFERENCES - URL TESTS
================================================================================

TEST 1: main/urls
================================================================================

PROBLEM 1: Import statements missing entirely
Lines 1-3 in expected output:

EXPECTED:
  1 | @import "css/background.css";
  2 | @import "import/import-test-d.css";
  3 | @import "file.css";
  4 | .gray-gradient {

ACTUAL (starts immediately with):
  1 | @font-face {
  2 |   src: url("/fonts/garamond-pro.ttf");
  3 |   src: local(Futura-Medium), url(fonts.svg#MyGeometricModern) format("svg");

STATUS: CRITICAL - All @import statements from the Less file are lost


PROBLEM 2: Relative path rewriting error
Line 42 in expected vs actual:

EXPECTED:
 42 | #imported-relative-path {
 43 |   background-image: url(../data/image.jpg);
 44 |   border-image: url('../data/image.jpg');

ACTUAL:
 42 | #imported-relative-path {
 43 |   background-image: url(../../data/image.jpg);
 44 |   border-image: url('../../data/image.jpg');

PATTERN: Adding an extra "../" - one parent directory level too many
AFFECTS: Lines 43-44 (relative paths in imported files)


================================================================================
TEST 2: static-urls/urls
================================================================================

Configuration: rootpath: "folder (1)/"

PROBLEM 1: Import statements missing
EXPECTED:
  1 | @import "css/background.css";
  2 | @import "folder (1)/import-test-d.css";

ACTUAL (starts with):
  1 | @font-face {
  2 |   src: url("/fonts/garamond-pro.ttf");

STATUS: CRITICAL - Same issue as test 1


PROBLEM 2: Relative path rewriting
Lines 42-46:

EXPECTED:
 43 | #imported-relative-path {
 44 |   background-image: url(../data/image.jpg);
 45 |   border-image: url('../data/image.jpg');

ACTUAL:
 42 | #imported-relative-path {
 43 |   background-image: url(../../data/image.jpg);
 44 |   border-image: url('../../data/image.jpg');

PATTERN: Same "too many ../" bug as test 1


WORKING CORRECTLY:
- Path escaping with rootpath: "folder (1)/"
  url(folder\ \(1\)/fonts.svg#MyGeometricModern) ✓
  url(folder\ \(1\)/images/image.jpg) ✓
  url(folder\ \(1\)/bg.jpg) ✓
  These all correctly have spaces escaped with backslash


================================================================================
TEST 3: url-args/urls
================================================================================

Configuration: urlArgs: "424242"

PROBLEM: urlArgs query string NOT being appended

Expected: All non-data-URI URLs should have ?424242 appended

EXAMPLE 1 - Line 2 (absolute path):
EXPECTED:
  2 |   src: url("/fonts/garamond-pro.ttf?424242");

ACTUAL:
  2 |   src: url("/fonts/garamond-pro.ttf");
     Missing: ?424242


EXAMPLE 2 - Line 6 (relative path with query string already exists):
EXPECTED:
  6 |   background: url("http://www.lesscss.org/spec.html?424242") no-repeat 0 4px;

ACTUAL:
  6 |   background: url("http://www.lesscss.org/spec.html") no-repeat 0 4px;
     Missing: ?424242


EXAMPLE 3 - Line 19 (URL with existing query parameters):
EXPECTED:
 19 |   background-image: url(http://fonts.googleapis.com/css?family=\"Rokkitt\":\(400\),700&424242);

ACTUAL:
 19 |   background-image: url(http://fonts.googleapis.com/css?family=\"Rokkitt\":\(400\),700);
     Missing: &424242 (should append with & since query string exists)


EXAMPLE 4 - Line 26 (Multiple URLs):
EXPECTED:
 26 |   background: url(bg.jpg?424242) no-repeat, url(bg.png?424242) repeat-x top left, url(bg?424242);

ACTUAL:
 26 |   background: url(bg.jpg) no-repeat, url(bg.png) repeat-x top left, url(bg);
     Missing: ?424242 on ALL three URLs


EXAMPLE 5 - Line 29 (Variable value URL):
EXPECTED:
 29 |   url: url('Trebuchet?424242');

ACTUAL:
 29 |   url: url('Trebuchet');
     Missing: ?424242


CORRECTLY NOT MODIFIED (DATA URIs):
✓ Data URI URLs are correctly left untouched:
  url(data:image/png;charset=utf-8;base64,...) - NOT modified (correct!)
  url(data:image/x-png,...) - NOT modified (correct!)
  url('data:image/svg+xml, ...' ) - NOT modified (correct!)

STATUS: BROKEN - urlArgs option is completely non-functional


================================================================================
SUMMARY OF ISSUES
================================================================================

ISSUE #1: Import Statement Loss
- Severity: CRITICAL
- Affects: All 3 tests (main/urls, static-urls/urls, url-args/urls)
- Expected: @import directives appear at beginning of CSS output
- Actual: @import directives disappear completely
- Impact: CSS output is invalid when imports are required
- Probable location: Import collection/output ordering in render pipeline

ISSUE #2: Extra Parent Directory in Relative Paths
- Severity: HIGH
- Affects: Tests with relative imports (main/urls, static-urls/urls)
- Expected: ../data/image.jpg (stays as is)
- Actual: ../../data/image.jpg (one level too deep)
- Impact: Broken image/resource references in CSS
- Probable location: Path normalization in URL rewriting, especially for relative includes

ISSUE #3: urlArgs Not Applied to URLs
- Severity: HIGH  
- Affects: url-args/urls test
- Expected: All non-data-URI URLs have query string appended
- Actual: No query strings added at all
- Impact: Cache busting feature completely broken
- Probable location: urlArgs option processing in URL handling functions

================================================================================
